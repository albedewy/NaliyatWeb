<div class="create-trip-container">
  <div class="page-header">
    <h1>{{ '::Trip:CreateNewTrip' | abpLocalization }}</h1>
    <p>{{ '::Trip:CreateTripSubtitle' | abpLocalization }}</p>
  </div>

  @if (errorMessage) {
    <div class="alert alert-danger">
      <i class="fa fa-exclamation-circle"></i>
      {{ errorMessage }}
    </div>
  }

  <form [formGroup]="tripForm" (ngSubmit)="onSubmit()" class="trip-form">
    <!-- Location Section -->
    <div class="form-section">
      <h3><i class="fa fa-map-marker"></i> {{ '::Trip:LocationDetails' | abpLocalization }}</h3>
      <div class="form-row">
        <div class="form-group">
          <label for="fromLocation">{{ '::Trip:PickupLocation' | abpLocalization }} <span class="required">*</span></label>
          <input
            type="text"
            id="fromLocation"
            formControlName="fromLocation"
            [placeholder]="'::Trip:PickupLocationPlaceholder' | abpLocalization"
            [class.is-invalid]="isFieldInvalid('fromLocation')"
          />
          @if (isFieldInvalid('fromLocation')) {
            <span class="error-message">{{ getFieldError('fromLocation') }}</span>
          }
        </div>
        <div class="form-group">
          <label for="toLocation">{{ '::Trip:DropOffLocation' | abpLocalization }} <span class="required">*</span></label>
          <input
            type="text"
            id="toLocation"
            formControlName="toLocation"
            [placeholder]="'::Trip:DropOffLocationPlaceholder' | abpLocalization"
            [class.is-invalid]="isFieldInvalid('toLocation')"
          />
          @if (isFieldInvalid('toLocation')) {
            <span class="error-message">{{ getFieldError('toLocation') }}</span>
          }
        </div>
      </div>
    </div>

    <!-- Schedule Section -->
    <div class="form-section">
      <h3><i class="fa fa-calendar"></i> {{ '::Trip:Schedule' | abpLocalization }}</h3>
      <div class="form-row">
        <div class="form-group">
          <label for="startDate">{{ '::Trip:StartDate' | abpLocalization }} <span class="required">*</span></label>
          <input
            type="datetime-local"
            id="startDate"
            formControlName="startDate"
            [class.is-invalid]="isFieldInvalid('startDate')"
          />
          @if (isFieldInvalid('startDate')) {
            <span class="error-message">{{ getFieldError('startDate') }}</span>
          }
        </div>
        <div class="form-group">
          <label for="endDate">{{ '::Trip:EndDate' | abpLocalization }} <span class="required">*</span></label>
          <input
            type="datetime-local"
            id="endDate"
            formControlName="endDate"
            [class.is-invalid]="isFieldInvalid('endDate')"
          />
          @if (isFieldInvalid('endDate')) {
            <span class="error-message">{{ getFieldError('endDate') }}</span>
          }
        </div>
      </div>
    </div>

    <!-- Cargo Section -->
    <div class="form-section">
      <h3><i class="fa fa-cube"></i> {{ '::Trip:CargoDetails' | abpLocalization }}</h3>
      <div class="form-row">
        <div class="form-group">
          <label for="goodsType">{{ '::Trip:GoodsType' | abpLocalization }} <span class="required">*</span></label>
          <input
            type="text"
            id="goodsType"
            formControlName="goodsType"
            [placeholder]="'::Trip:GoodsTypePlaceholder' | abpLocalization"
            [class.is-invalid]="isFieldInvalid('goodsType')"
          />
          @if (isFieldInvalid('goodsType')) {
            <span class="error-message">{{ getFieldError('goodsType') }}</span>
          }
        </div>
        <div class="form-group">
          <label for="goodsWeight">{{ '::Trip:Weight' | abpLocalization }} <span class="required">*</span></label>
          <input
            type="number"
            id="goodsWeight"
            formControlName="goodsWeight"
            [placeholder]="'::Trip:WeightPlaceholder' | abpLocalization"
            min="1"
            [class.is-invalid]="isFieldInvalid('goodsWeight')"
          />
          @if (isFieldInvalid('goodsWeight')) {
            <span class="error-message">{{ getFieldError('goodsWeight') }}</span>
          }
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="goodsDimensions">{{ '::Trip:Dimensions' | abpLocalization }}</label>
          <input
            type="text"
            id="goodsDimensions"
            formControlName="goodsDimensions"
            [placeholder]="'::Trip:DimensionsPlaceholder' | abpLocalization"
          />
        </div>
        <div class="form-group">
          <label for="truckTypeId">{{ '::Trip:TruckType' | abpLocalization }} <span class="required">*</span></label>
          <select
            id="truckTypeId"
            formControlName="truckTypeId"
            [class.is-invalid]="isFieldInvalid('truckTypeId')"
          >
            @for (type of truckTypes; track type.value) {
              <option [value]="type.value">{{ type.key }}</option>
            }
          </select>
          @if (isFieldInvalid('truckTypeId')) {
            <span class="error-message">{{ getFieldError('truckTypeId') }}</span>
          }
        </div>
      </div>
    </div>

    <!-- Additional Info Section -->
    <div class="form-section">
      <h3><i class="fa fa-info-circle"></i> {{ '::Trip:AdditionalInformation' | abpLocalization }}</h3>
      <div class="form-group full-width">
        <label for="notes">{{ '::Trip:Notes' | abpLocalization }}</label>
        <textarea
          id="notes"
          formControlName="notes"
          rows="4"
          [placeholder]="'::Trip:NotesPlaceholder' | abpLocalization"
        ></textarea>
      </div>
    </div>

    <!-- Submit Section -->
    <div class="form-actions">
      <button type="button" class="btn-secondary" routerLink="/trip/list">
        {{ '::Trip:Cancel' | abpLocalization }}
      </button>
      <button type="submit" class="btn-primary" [disabled]="isSubmitting">
        @if (isSubmitting) {
          <i class="fa fa-spinner fa-spin"></i> {{ '::Trip:Creating' | abpLocalization }}
        } @else {
          <i class="fa fa-plus"></i> {{ '::Trip:CreateTrip' | abpLocalization }}
        }
      </button>
    </div>
  </form>
</div>
