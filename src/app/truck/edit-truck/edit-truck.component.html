<div class="edit-truck-container">
  <div class="back-link">
    <a routerLink="/truck/list">
      <i class="fa fa-arrow-left"></i> Back to My Trucks
    </a>
  </div>

  @if (isLoading) {
    <div class="loading-state">
      <i class="fa fa-spinner fa-spin"></i>
      <p>Loading truck details...</p>
    </div>
  } @else {
    <div class="form-card">
      <div class="card-header">
        <div class="header-icon">
          <i class="fa fa-pencil"></i>
        </div>
        <div>
          <h1>Edit Truck</h1>
          <p>Update your truck details</p>
        </div>
      </div>

      @if (errorMessage) {
        <div class="alert alert-danger">
          <i class="fa fa-exclamation-circle"></i>
          {{ errorMessage }}
        </div>
      }

      <form [formGroup]="truckForm" (ngSubmit)="onSubmit()">
        <div class="form-section">
          <h3><i class="fa fa-info-circle"></i> Basic Information</h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="make">Make <span class="required">*</span></label>
              <input
                type="text"
                id="make"
                formControlName="make"
                placeholder="e.g., Volvo, Mercedes, Scania"
                [class.is-invalid]="isFieldInvalid('make')"
              />
              @if (isFieldInvalid('make')) {
                <span class="error-message">Make is required</span>
              }
            </div>
            <div class="form-group">
              <label for="model">Model <span class="required">*</span></label>
              <input
                type="text"
                id="model"
                formControlName="model"
                placeholder="e.g., FH16, Actros"
                [class.is-invalid]="isFieldInvalid('model')"
              />
              @if (isFieldInvalid('model')) {
                <span class="error-message">Model is required</span>
              }
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="year">Year <span class="required">*</span></label>
              <select
                id="year"
                formControlName="year"
                [class.is-invalid]="isFieldInvalid('year')"
              >
                <option value="">Select Year</option>
                @for (year of yearOptions; track year) {
                  <option [value]="year">{{ year }}</option>
                }
              </select>
              @if (isFieldInvalid('year')) {
                <span class="error-message">Year is required</span>
              }
            </div>
            <div class="form-group">
              <label for="truckTypeId">Truck Type <span class="required">*</span></label>
              <select
                id="truckTypeId"
                formControlName="truckTypeId"
                [class.is-invalid]="isFieldInvalid('truckTypeId')"
              >
                @for (option of truckTypeOptions; track option.value) {
                  <option [ngValue]="option.value">{{ option.key }}</option>
                }
              </select>
              @if (isFieldInvalid('truckTypeId')) {
                <span class="error-message">Truck type is required</span>
              }
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3><i class="fa fa-id-card"></i> Registration Details</h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="licenseNumber">License Number <span class="required">*</span></label>
              <input
                type="text"
                id="licenseNumber"
                formControlName="licenseNumber"
                placeholder="Enter license plate number"
                [class.is-invalid]="isFieldInvalid('licenseNumber')"
              />
              @if (isFieldInvalid('licenseNumber')) {
                <span class="error-message">License number is required</span>
              }
            </div>
            <div class="form-group">
              <label for="registrationNumber">Registration Number</label>
              <input
                type="text"
                id="registrationNumber"
                formControlName="registrationNumber"
                placeholder="Enter registration number (optional)"
              />
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3><i class="fa fa-cog"></i> Specifications</h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="maxLoad">Max Load (kg)</label>
              <input
                type="number"
                id="maxLoad"
                formControlName="maxLoad"
                placeholder="Enter maximum load capacity"
                min="0"
              />
            </div>
            <div class="form-group">
              <label for="temperatureRequirement">Temperature Requirement</label>
              <select
                id="temperatureRequirement"
                formControlName="temperatureRequirement"
              >
                @for (option of temperatureOptions; track option.value) {
                  <option [ngValue]="option.value">{{ option.key }}</option>
                }
              </select>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-cancel" routerLink="/truck/list">
            Cancel
          </button>
          <button type="submit" class="btn-submit" [disabled]="isSubmitting">
            @if (isSubmitting) {
              <i class="fa fa-spinner fa-spin"></i> Saving...
            } @else {
              <i class="fa fa-save"></i> Save Changes
            }
          </button>
        </div>
      </form>
    </div>
  }
</div>
